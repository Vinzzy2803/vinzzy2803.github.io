
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<title>Tableau Voice Control</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Creating Vinzzy">
		<meta name="author" content="Vinit Ganatra">

		<script src="annyang.min.js"></script> <!-- Voice Recognition -->
		<script src="responsivevoice.js"></script> <!-- Voice Response -->
		<script src="https://public.tableau.com/javascripts/api/tableau-2.min.js" type="text/javascript"></script> 
<link rel="stylesheet" type="text/css" href="style.css"/>
</head>	

<body bgcolor="#313131" onload="initViz();">
<img src="deloitte-logo.svg" class="logo_deloitte" alt="Deloitte">

<h3 class="font dashboardheader"> <center> <font color='white'>Storm Tracking Dashboard</font color> <center> </h3>
<br>
<br>
<center><div id='tableauViz'></div></center>

<script>
if (annyang) {
  // These are the voice commands in quotes followed by the function
 var commands = {
 	//'Select Colin': function() { selectColin(); responsiveVoice.speak('selecting Colin'); },
 
	/*'Hello *val': function(val){
	'select'+val+'();';
	var hh='selecting'+' '+val;
	
	responsiveVoice.speak(hh);
	},*/
	'Hello *val': function(val){ 
		var hh='selecting'+' '+val;
		responsiveVoice.speak(hh);
	//SelectStorm(val);
	}
	
	
  // Add commands to annyang
  annyang.addCommands(commands);
  //annyang.addCommands(commands2);
  // Start listening.
  annyang.start();
  annyang.debug();
  //annyang.setPrefix('Hello, Tableau');


}
</script>

<script>
var viz, workbook, activeSheet, Worksheet, worksheet;
function initViz(){

var placeholderDiv = document.getElementById("tableauViz");

var url = "http://public.tableau.com/views/RegionalSampleWorkbook/Storms";
var options = {
   width: "1004",   
   height: "869",
   hideTabs: true,
   hideToolbar: true,
  onFirstInteractive: function () {
  workbook = viz.getWorkbook();
  activeSheet = workbook.getActiveSheet();
}
};
  viz = new tableauSoftware.Viz(placeholderDiv, url, options);
}

//Vinzzy says hello
responsiveVoice.speak('Welcome to Storm Tracking Dashboard. How may I help you?','UK English Male');


//Make Storm selection

 function SelectStorm(stm) {
            var sheet = viz.getWorkbook().getActiveSheet();
            if (stm === "") {
                sheet.clearFilterAsync("Storm Name");
            } else {
                sheet.applyFilterAsync("Storm Name", stm, tableau.FilterUpdateType.REPLACE);
            }
        }

     	
	 function filterBasinAtlantic()
    {
    activeSheet.getWorksheets()[1].applyFilterAsync('Basin', 'Atlantic', tableauSoftware.FilterUpdateType.REPLACE); 
    }
	
	function filterBasinEastPacific()
    {
    activeSheet.getWorksheets()[1].applyFilterAsync('Basin', 'East Pacific', tableauSoftware.FilterUpdateType.REPLACE); 
    }
	
	function filterBasinWestPacific()
    {
    activeSheet.getWorksheets()[1].applyFilterAsync('Basin', 'West Pacific', tableauSoftware.FilterUpdateType.REPLACE); 
    }
	
	function removeFilter()
{
activeSheet.getWorksheets()[0].applyFilterAsync('Basin', ['Atlantic', 'East Pacific', 'West Pacific'],tableauSoftware.FilterUpdateType.ALL); 
}

function exportPDF()
{

viz.showExportPDFDialog();
}


	
//Start Viz Over
function startover()
	{

	viz.revertAllAsync();
	}
	
</script>

</body>
<style>
.logo_deloitte
{
 position:absolute;
  height:50px;
  width:200px;
  left:20px;
  top:30px;
  filter: grayscale(000%); 
}

.logo_deloitte:hover{
 filter: grayscale(100%);
}

#tableauViz
{
position:absolute;
top:100px;
left:20%;

}
</style>

</html>		
		
		